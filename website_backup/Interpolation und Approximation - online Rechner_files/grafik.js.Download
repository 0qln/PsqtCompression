function WPoint(a,b){if(a==undefined){this.x=0;this.y=0}else if(typeof a=='object'){this.x=a.x;this.y=a.y}else{this.x=a;this.y=b}}WPoint.prototype.normiere=function(){const A=this.abs();if(A>0.0){this.x /=A;this.y /=A}return this};WPoint.prototype.abs=function(){return Math.sqrt(this.x*this.x+this.y*this.y)};function Scales(A,B){if(A>B){const C=A;A=B;B=C}this.smin=A;this.smax=B;const D=this.smax-this.smin,E=Math.log(D)/Math.log(10);var F=E|0;if(E<0)--F;const G=D/Math.pow(10,F);this.dTic=Math.pow(10,F);if(G<5)this.dTic*=0.1;this.dLabel=5*this.dTic;if(D/this.dLabel<2)this.dLabel*=0.2;if(D/this.dTic>40)this.dTic*=5;function toInt(H){return H>0?(H|0):-((-H)|0)}function fmod(H,I){return H-I*toInt(H/I)}this.getTics=function(){const J=[];var K;if(this.smin<0.0||fmod(this.smin,this.dTic)===0.0)K=toInt(this.smin/this.dTic)*this.dTic;else K=toInt((this.smin/this.dTic)+1.0)*this.dTic;if(K<this.smin)K+=this.dTic;var L=0;J[L]=K;while(J[L]<=this.smax){++L;J[L]=J[L-1]+this.dTic}return J};this.getLabels=function(){const M=[];var N;if(this.smin<0.0||fmod(this.smin,this.dTic)===0.0)N=toInt(this.smin/this.dLabel)*this.dLabel;else N=toInt((this.smin/this.dLabel)+1.0)*this.dLabel;if(N<this.smin)N+=this.dLabel;var L=0;M[L]=N;while(M[L]<=this.smax){++L;M[L]=M[L-1]+this.dLabel}return M};}var ctx,canvas,zoomstate=0,curx,cury,xmit,ymit,xfak,yfak,GR_W=600,GR_H=400,GR_WH=GR_W>>1,GR_HH=GR_H>>1,scaleFactor=0.85;function setMinMax(A,B,C,D,E){var F=C-A,G=D-B;if(F===0)F=G;if(G===0)G=F;if(F===0&&G===0)F=G=2.2;if(G<Math.max(Math.abs(B),Math.abs(D))*1e-7)G=Math.abs(D)*0.05;GR_W=canvas.width;GR_H=canvas.height;GR_WH=GR_W>>1;GR_HH=GR_H>>1;if(zoomstate===0){xmit=(A+C)*0.5;ymit=(B+D)*0.5}xfak=GR_W / F;yfak=GR_H / G;if(E==0){if(xfak<yfak)yfak=xfak;else xfak=yfak}if(E==0||E==2)xfak*=scaleFactor;yfak*=scaleFactor}function setMinMaxArray(p,A){var B,C,D,E,F=!0,G,H;const I=p.length;if(p[0][0]){B=C=p[0][0].x;D=E=p[0][0].y;for(G=I;--G>=0;){const J=p[G];for(H=J.length;--H>=0;){if(J[H]===null)continue;F=!1;if(C>J[H].x)C=J[H].x;else if(B<J[H].x)B=J[H].x;if(E>J[H].y)E=J[H].y;else if(D<J[H].y)D=J[H].y}}}else{B=C=p[0].x;D=E=p[0].y;for(G=I;--G>=1;){if(p[G]===null)continue;F=!1;if(C>p[G].x)C=p[G].x;else if(B<p[G].x)B=p[G].x;if(E>p[G].y)E=p[G].y;else if(D<p[G].y)D=p[G].y}}if(F){C-=1.0;B+=1.0;E-=1.0;D+=1.0}setMinMax(C,E,B,D,A);return[C,E,B,D]}function getwmaxx(){return xmit+(GR_W>>1)/xfak}function getwminx(){return xmit-(GR_W>>1)/xfak}function getwmaxy(){return ymit+(GR_H>>1)/yfak}function getwminy(){return ymit-(GR_H>>1)/yfak}function worldx(A){return xmit+(A-GR_WH)/xfak}function worldy(A){return ymit-(A-GR_HH)/yfak}function screenx(o){var A=o.x!==undefined?o.x:o;return GR_WH+((A-xmit)*xfak|0);}function screeny(o){var A=o.y!==undefined?o.y:o;return GR_HH-((A-ymit)*yfak|0);}function wLineTo(a,b){if(b!=undefined){curx=screenx(a);cury=screeny(b)}else{curx=screenx(a.x);cury=screeny(a.y)}ctx.lineTo(curx,cury)}function wMoveTo(a,b){if(b!=undefined){curx=screenx(a);cury=screeny(b)}else{curx=screenx(a.x);cury=screeny(a.y)}ctx.moveTo(curx,cury)}function textWidth(s){return ctx.measureText(s).width}function drawString(s,x,y){function getTok(s){const A=s.length;for(var B=1;B<A;++B){switch(s[B]){case'>':++B;case'<':return s.substring(0,B)}}return s}while(s.length>0){const C=getTok(s);s=s.substring(C.length);switch(C){case'<sup>':case'</sub>':y-=4;break;case'<sub>':case'</sup>':y+=4;break;default:if(C.substring(0,2)=='<c')ctx.fillStyle=C.substring(3,C.length-1);else{ctx.fillText(C,x,y);x+=textWidth(C)}break}}}function trueLen(s){const A=s.replace(/<.*>/g,'');return A.length}function drawPolygon(p){var A=p.length-1;wMoveTo(p[A]);while(--A>=0)wLineTo(p[A])}function drawPolygonInterrupted(p,A){var B=p.length-1;wMoveTo(p[B]);while(--B>=0){if(A[B]&&A[B+1])wLineTo(p[B]);else if(A[B])wMoveTo(p[B])}}function labelStr(A){var B,C,D;if(Math.abs(A)<1e-12)A=0;if(Math.abs(A)>=10&&Math.abs(A)<10000)B=A.toFixed(0);else{B=A.toPrecision(3);if(B.indexOf('00e')>0)B=B.replace('00e','e')}D=B.indexOf('.');if(D<0)return B;D=B.indexOf('e');if(D>0)return B;C=B.length-1;while(C>0&&B.charAt(C)=='0')--C;if(B.charAt(C)=='.')--C;return B.substring(0,C+1)}function ax_x(){var A;const B=new Scales(getwminx(),getwmaxx()),C=B.getTics(),D=Math.abs(worldy(8)-worldy(0));for(A=C.length;--A>=0;){wMoveTo(C[A],0.0);wLineTo(C[A],-D)}wMoveTo(getwminx(),0.0);wLineTo(getwmaxx(),0.0);const E=B.getLabels();for(A=E.length;--A>=0;){const F=E[A];drawString(labelStr(F),screenx(F)+2,screeny(0.0)+12)}}function ax_y(){const A=new Scales(getwminy(),getwmaxy()),B=A.getTics(),C=worldx(8)-worldx(0);var D,E,F,G;for(D=B.length;--D>=0;){wMoveTo(0,B[D]);wLineTo(-C,B[D])}wMoveTo(0.0,getwminy());wLineTo(0.0,getwmaxy());const H=A.getLabels();if(H.length===0)return;F=0;for(D=H.length;--D>=0;){G=labelStr(H[D]).length;if(G>F)F=G}if(F<=2)E=16;else if(F<=3)E=21;else E=36;for(D=H.length;--D>=0;){const I=H[D];drawString(labelStr(I),screenx(0)-E,screeny(I)-3)}}function axes(){if(getwminy()*getwmaxy()<0&&getwminx()*getwmaxx()<0){ax_x();ax_y()}else{border_x();border_y()}}function axTitles(A,B){if(A==undefined){A='x';B='y'}var C=screenx(getwmaxx())-10-trueLen(A)*7,D=screeny(0.0)+20;drawString(A,C,D);C=screenx(0)+10;D=screeny(getwmaxy())+20;drawString(B,C,D)}function border_x(){var A;const B=new Scales(getwminx(),getwmaxx()),C=B.getTics(),D=Math.abs(worldy(8)-worldy(0)),E=getwminy();for(A=C.length;--A>=0;){wMoveTo(C[A],E);wLineTo(C[A],E+D)}wMoveTo(getwminx(),0.0);wLineTo(getwmaxx(),0.0);const F=B.getLabels();for(A=F.length;--A>=0;){const G=F[A];drawString(labelStr(G),screenx(G)+2,screeny(E)-7)}}function border_y(){var A;const B=new Scales(getwminy(),getwmaxy()),C=B.getTics(),D=worldx(8)-worldx(0),E=getwminx();for(A=C.length;--A>=0;){wMoveTo(E,C[A]);wLineTo(E+D,C[A])}wMoveTo(0.0,getwminy());wLineTo(0.0,getwmaxy());const F=B.getLabels();for(A=F.length;--A>=0;){const G=F[A];drawString(labelStr(G),screenx(E)+2,screeny(G)-3)}}function grid(){const A=getwminy(),B=getwmaxy(),C=getwminx(),D=getwmaxx(),E=new Scales(A,B),F=E.getTics(),G=new Scales(C,D),H=G.getTics();var I;ctx.translate(-0.5,-0.5);for(I=H.length;--I>=0;){wMoveTo(H[I],A);wLineTo(H[I],B)}for(I=F.length;--I>=0;){wMoveTo(C,F[I]);wLineTo(D,F[I])}wMoveTo(C,A);wLineTo(D,A);wLineTo(D,B);wLineTo(C,B);wLineTo(C,A);ctx.translate(0.5,0.5)}function arrow(A,B,C,D,E,F){var G,H,I,J,K=0.35;const L=Math.sqrt(C*C+D*D);if(L===0)return;if(E!=0){A-=C;B-=D}wMoveTo(A,B);wLineTo(A+C,B+D);A+=C;B+=D;C=-0.24*C;D=-0.24*D;const M=Math.abs(10/(L*0.24*xfak));if(M<1.0){C*=M;D*=M;K=0.25}G=A+C+K*D;H=A+C-K*D;I=B+D-K*C;J=B+D+K*C;wMoveTo(G,I);wLineTo(A,B);wLineTo(H,J);if(F)ctx.fill()}
